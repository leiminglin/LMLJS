/**
 * LMLJS Framework
 * Copyright (c) 2014 http://lmlphp.com All rights reserved.
 * Licensed ( http://mit-license.org/ )
 * Author: leiminglin <leiminglin@126.com>
 *
 * A lovely javascript framework.
 *
 * $id: $
 *
 */
!function(a,b,c){function d(a){return a={},a.queue=[],a.running=0,a.promise=function(){a.queue.length?(a.running=1,a.queue.shift()()):a.running=0},a.then=function(b){a.queue.push(b)},a.front=function(b){a.queue.unshift(b)},a}function h(){function c(c){b.push(c),a.onresize=function(){for(var a in b)b[a]()}}var b=[];return c}function i(c){function f(c,d,e,f){e=b.createElement("script"),f=b.getElementsByTagName("script")[0],e.async=1,e.src=c;try{f.parentNode.insertBefore(e,f),a.addEventListener?e.addEventListener("load",d,!1):a.attachEvent?e.onreadystatechange=function(){this.readyState.match(/loaded|complete/i)&&d()}:e.onload=function(){d()}}catch(a){d()}}function h(a,b,d,e){function f(e,g){e=a.shift(),g=a.shift(),a.unshift(g),i(e,function(){g?(f(),c[g].callback.running||i.start(g)):b()},d)}e=a[0],f()}function i(a,b,g,j){function k(){function d(){f(a,function(){c[a].loaded=1,b(),i.start(a)})}g=g+""=="1"?1:0,g?d():c[a].start||c[a].loaded?(b(),i.start(a)):d(),c[a].start=1}return"object"==typeof a&&a instanceof Array?h(a,b):(b=b||function(){e.promise()},c[a]?c[a].callback.then(k):(j=d(),j.then(k),c[a]={loaded:0,start:0,callback:j}),void(c[a].callback.running||i.start(a)))}return c={},i.competeLoad=function(a,b,c,d,e,f){for(e=0,f=a.length;e<f;e++)i(a.shift(),function(){return this.flag?c():(b(),void(this.flag=1))},d)},i.start=function(a,b){if(g.onload)if(a)c[a].callback.promise();else for(b in c)c[b].callback.promise()},i}function k(c){var f,g,d=c.offsetTop,e=c.offsetParent;if(null==e&&c.parentNode)for(f=c.parentNode;null==e&&(e=f.offsetParent,f=f.parentNode););for(;e;)d+=e.offsetTop+e.clientTop,e=e.offsetParent;return"number"==typeof a.pageYOffset?g=a.pageYOffset:(docElement=b.compatMode&&"CSS1Compat"===b.compatMode?b.documentElement:b.body,g=docElement.scrollTop),d-g}function l(){return b.compatMode&&"BackCompat"==b.compatMode&&b.body?{width:b.body.clientWidth,height:b.body.clientHeight}:{width:b.documentElement.clientWidth,height:b.documentElement.clientHeight}}function m(a,c){c=b.createElement("style"),c.type="text/css",c.styleSheet?c.styleSheet.cssText=a:c.innerHTML=a,b.getElementsByTagName("head")[0].appendChild(c)}var e=d(),f=i(),g={};g.registerOnResize=h(),e.then(function(){function p(){if(m>=h.length)return void(a.addEventListener?b.removeEventListener("scroll",p,!1):a.attachEvent&&a.detachEvent(event,p));for(c=0,j=h.length;c<j;c++)h[c].getAttribute("src")||(n=k(h[c]),o=h[c].getAttribute("height")||0,n>=-o&&n<i.height&&(f=h[c].getAttribute("osrc"))&&(h[c].setAttribute("src",f),h[c].onerror=function(){(f=this.getAttribute("osrc-bak"))&&(this.setAttribute("src",f),this.onerror=null)},h[c].onload=function(){m++}))}var c,f,n,o,h=b.getElementsByTagName("IMG"),i=l(),m=0;g.registerOnResize(function(){i=l()}),a.addEventListener?b.addEventListener("scroll",p,!1):a.attachEvent&&a.attachEvent("onscroll",p),p();var q=1,r=function(){p(),q*=2,q>1e3&&(q=1e3),setTimeout(r,q)};setTimeout(r,q),e.promise()}),"function"!=typeof b.getElementsByClassName&&(b.getElementsByClassName=function(a){var f,g,a,c=b.getElementsByTagName("*"),d=new RegExp("\\b"+a+"\\b"),e=[];for(f=0,g=c.length;f<g;f++)a=c[f].className,d.test(a)&&e.push(c[f]);return e}),e.then(function(a,c){for(a=b.getElementsByClassName("lazyCss"),c=0;c<a.length;c++)m(a[c].value||a[c].innerHTML);e.promise()}),e.then(function(){var c,d,a=b.getElementsByClassName("lazyHtml");for(c=0;c<a.length;c++)"TEXTAREA"==a[c].tagName&&(d=b.createElement("DIV"),d.innerHTML=a[c].value,a[c].parentNode.insertBefore(d,a[c]));e.promise()}),g.deferred=e,g.createDeferred=d,g.loadJs=f,g.onload=0,g.run=function(){},a.lml=g;var n=function(){};"function"==typeof a.onload&&(n=a.onload),a.onload=function(){g.onload=1,e.promise(),f.start(),n()}}(window,document);
